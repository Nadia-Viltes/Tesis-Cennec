{% extends 'base/base.html' %}

<!-- ================================================ -->
<!-- PANTALLA TURNOS -->
<!-- ================================================ -->
{% block turnos %}

<main class="col-md-9 ms-sm-auto col-lg-10">
  <div class="chartjs-size-monitor">
    <div class="chartjs-size-monitor-expand">
      <div class></div>
    </div>
    <div class="chartjs-size-monitor-shrink">
      <div class=""></div>
    </div>
  </div>

  <!-- Breadcrumb -->
  <nav
    style="--bs-breadcrumb-divider: url(&#34;data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='currentColor'/%3E%3C/svg%3E&#34;);"
    aria-label="breadcrumb">
    <ol class="breadcrumb bg-light" style="padding: 15px; border: 0">
      <li class="breadcrumb-item"><a href="/home">Home</a></li>
      <li class="breadcrumb-item"><a href="/reportes">Reportes</a></li>
      <li class="breadcrumb-item active" aria-current="page">{{ data.titulo }}</li>
    </ol>
  </nav>

  <!-- Titulo de la pantalla -->
  <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center border-bottom pb-0">
    <h1 class="h2">{{ data.titulo }}</h1>
  </div>


  <!-- ================================================ -->
  <!-- REPORTES  -->
  <!-- ================================================ -->
  <section>
    <div class="row">
      <div class="col-md-4 m-4">
        <div class="form-floating">
          <select class="form-select" id="floatingSelectGrid" aria-label="Floating label select example">
            <option selected>Una semana</option>
            <option value="1">Un mes</option>
            <option value="2">Seis meses</option>
            <option value="3">Un año</option>
          </select>
          <label for="floatingSelectGrid">Selecciona un periodo</label>
        </div>
      </div>
    </div>
  </section>


  <section>
    <div class="row">
      <div class="col-lg-8 col-md-6 mb-4" id="cardGrafico">
        <div class="card">
          <div class="card-body">
            <canvas id="charEstadoTurnos"></canvas>
          </div>
        </div>
      </div>

      <div class="col-lg-3 col-md-6 mb-4">
        <div class="card">
          <div class="card-body">
            <p class="text-uppercase small mb-2">
              <strong>Total de turnos últimos 30 días</strong>
            </p>
            <h5 class="mb-0">
              <strong>{{data.periodos_turnos[0]}}</strong>
              {% if data.periodos_turnos[0] > data.periodos_turnos[1] %}
              <small class="text-success ml-2">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-up-short" viewBox="0 0 16 16">
                  <path fill-rule="evenodd" d="M8 12a.5.5 0 0 0 .5-.5V5.707l2.146 2.147a.5.5 0 0 0 .708-.708l-3-3a.5.5 0 0 0-.708 0l-3 3a.5.5 0 1 0 .708.708L7.5 5.707V11.5a.5.5 0 0 0 .5.5z"/>
                </svg>{{data.periodos_turnos[2]}}
              </small>
              {%else%}
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-down-short" viewBox="0 0 16 16">
                <path fill-rule="evenodd" d="M8 4a.5.5 0 0 1 .5.5v5.793l2.146-2.147a.5.5 0 0 1 .708.708l-3 3a.5.5 0 0 1-.708 0l-3-3a.5.5 0 1 1 .708-.708L7.5 10.293V4.5A.5.5 0 0 1 8 4z"/>
              </svg>{{data.periodos_turnos[2]}}
              {% endif %}
            </h5>
            <hr />
            <p class="text-uppercase text-muted small mb-2"></p> Periodo previo
            <h5 class="text-muted mb-0">{{data.periodos_turnos[1]}}</h5>
          </div>
        </div>
      </div>
    </div>
  </section>

<hr/>

  <section>
    <div class="row">
      <div class="col-lg-8 col-md-6 mb-4" id="cardGrafico">
        <h5 class="text-center">Resultados</h5>
        <div class="card">
          <div class="card-body">
            <table class="table">
              <thead>
                <tr>
                  <th scope="col">#</th>
                  <th scope="col">Cantidad</th>
                  <th scope="col">Estado</th>
                </tr>
              </thead>
              <tbody>
                {% for estados in data.estados_turnos %}
                <tr>
                  <td>{{loop.index}}</td>
                  <td>{{estados[0]}}</td>
                  <td>{{estados[1]}}</td>
                </tr>
                {% endfor %}
              </tbody>
              <tfoot>
                <tr>
                  <th scope="row">Total</th>
                  <td>Algo</td>
                  <td></td>
                </tr>
              </tfoot>
            </table>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- ================================================ -->
  <!-- Config Pantalla -->
  <!-- ================================================ -->

  <div class="my-4 w-100 chartjs-render-monitor" style="display: block; height: 100px; width: 1218px;">
  </div>

</main>
<script type="text/javascript" src="/static/validations/reports/grafico_barras.js"></script>
<script type="text/javascript" charset="UTF-8">
  const nombreColumnas = JSON.parse('{{ data.nombres_columnas|safe }}')
  const valoresColumnas = JSON.parse('{{ data.valores_columnas|safe }}')

  graficoBarras("charEstadoTurnos", "Estado de Turnos", nombreColumnas, valoresColumnas);
</script>  

{% endblock %}